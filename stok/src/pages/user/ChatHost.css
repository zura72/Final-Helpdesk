:root {
  --bg: #0f172a; /* header */
  --ink: #0f172a; /* text dark */
  --muted: #6b7280;
  --teal: #06b6d4;
  --green: #22c55e;
  --bot: #f3f4f6; /* bubble bot */
  --me: #dcfce7; /* bubble user */
  --paper: #f7f7f5; /* chat bg */
  --ring: #e5e7eb;
  --ring-strong: #d1d5db;
  --white: #ffffff;
}

* { box-sizing: border-box; }

/* root */
.chat-root {
  height: calc(100vh - 80px);
  min-height: 540px;
  max-width: 980px;
  margin: 12px auto;
  display: flex;
  flex-direction: column;
  background: var(--paper);
  border: 1px solid var(--ring);
  border-radius: 16px;
  overflow: hidden;
}

/* header */
.chat-header {
  height: 62px;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 14px;
  position: sticky;
  top: 0;
  z-index: 2;
  background: linear-gradient(135deg, var(--bg), #1e293b 60%, #0ea5e9 120%);
}

.glass {
  backdrop-filter: saturate(1.2) blur(4px);
  -webkit-backdrop-filter: saturate(1.2) blur(4px);
}

.chat-peer { display: flex; gap: 12px; align-items: center; }

.avatar {
  width: 36px; height: 36px; border-radius: 50%;
  display: grid; place-items: center;
  background: #334155; color: #fff; font-weight: 700;
  box-shadow: 0 4px 14px rgba(0,0,0,.18);
}

.peer-info { line-height: 1.1; }
.peer-name { font-weight: 700; letter-spacing: .2px; }
.peer-sub { font-size: 12px; color: #cbd5e1; display: flex; align-items: center; gap: 6px; }

.dot { width: 8px; height: 8px; border-radius: 50%; background: #22c55e; display: inline-block; }
.pulse { box-shadow: 0 0 0 0 rgba(34,197,94,.8); animation: pulse 1.8s infinite; }
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(34,197,94,.8); }
  70% { box-shadow: 0 0 0 8px rgba(34,197,94,0); }
  100%{ box-shadow: 0 0 0 0 rgba(34,197,94,0); }
}

.header-right { display: flex; align-items: center; gap: 10px; }

.user-mini { display: none; /* hide even on desktop */ flex-direction: column; margin-right: 6px; text-align: right; }
.user-name {
  font-weight: 600; font-size: 13px; color: #e5e7eb; max-width: 220px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.user-division {
  font-size: 11px; color: #cbd5e1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* logout */
.logout-btn {
  display: inline-flex; align-items: center; gap: 8px;
  background: rgba(255,255,255,.08); color: #fff;
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 12px; padding: 8px 12px; cursor: pointer;
  transition: transform .12s ease, background .2s ease, border-color .2s ease;
}
.logout-btn:hover { background: rgba(255,255,255,.14); transform: translateY(-1px); border-color: rgba(255,255,255,.28); }
.logout-btn svg { fill: #fff; display: block; }

/* body */
.chat-body {
  flex: 1; overflow-y: auto; padding: 14px 14px 8px;
  background: radial-gradient(#ececec 1px, transparent 1px) 0 0/22px 22px, var(--paper);
}

/* rows & bubble */
.row { width: 100%; display: flex; margin: 6px 0; }
.row.bot { justify-content: flex-start; }
.row.user { justify-content: flex-end; }

.enter { animation: slide-in .18s ease-out; }
@keyframes slide-in { from { transform: translateY(6px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

.bubble {
  max-width: 78%; padding: 10px 12px; border-radius: 14px;
  box-shadow: 0 1px 0 rgba(0,0,0,.05); font-size: 15px; color: var(--ink);
  word-break: break-word; animation: bubble-pop .12s ease-out;
}
@keyframes bubble-pop { from { transform: scale(.98); } to { transform: scale(1); } }
.bubble.bot { background: var(--bot); border-top-left-radius: 6px; }
.bubble.me  { background: var(--me);  border-top-right-radius: 6px; }

/* pastikan CTA di dalam bubble tetap klikable */
.bubble .help-cta, .bubble .help-btn { pointer-events: auto; }

/* typing dots */
.typing i {
  display: inline-block; width: 6px; height: 6px; margin: 0 2px;
  background: #9ca3af; border-radius: 50%; animation: blink 1.2s infinite;
}
.typing i:nth-child(2){ animation-delay: .15s; }
.typing i:nth-child(3){ animation-delay: .3s; }
@keyframes blink { 0%,80%,100%{opacity:.25;} 40%{opacity:1;} }

/* recap card */
.recap { background:#fff; border:1px solid var(--ring); border-radius:12px; padding:10px 12px; }
.recap-title { font-weight:700; margin-bottom:6px; }
.recap, .upload-ask, .help-hint { font-size:14px; }
.recap-grid { display:grid; grid-template-columns:120px 1fr; gap:6px 14px; }
.recap-grid .k { color:var(--muted); } .recap-grid .v { font-weight:600; }

/* small card animation */
.card-pop { animation: card-pop .18s ease-out; }
@keyframes card-pop { from{ transform:translateY(4px); opacity:0; } to{ transform:translateY(0); opacity:1; } }

/* buttons used elsewhere */
.pill-btn{
  margin-top:8px; background:var(--teal); color:#fff; border:none; border-radius:999px;
  padding:8px 14px; font-size:16px; font-weight:600; cursor:pointer;
  transition: filter .15s ease, transform .12s ease; box-shadow:0 6px 12px rgba(0,0,0,.1);
  margin-left:auto;
}
.pill-btn:hover{ filter:brightness(.95); transform:translateY(-2px); background-color:var(--green); }
.pill-btn:active{ transform:translateY(2px); }
.pill-btn:focus{ outline:none; box-shadow:0 0 0 3px rgba(0,165,233,.3); }

/* image preview */
.img-preview img{ max-width:260px; border-radius:12px; display:block; border:1px solid var(--ring-strong); }
.img-caption{ font-size:12px; color:var(--muted); margin-top:4px; }

.fade-in{ animation: fade-in .2s ease-out; }
@keyframes fade-in{ from{opacity:0;} to{opacity:1;} }

/* confirm bar (unused in sticky) */
.confirm-bar{ display:flex; gap:10px; margin-top:8px; }
.confirm-btn{
  background:var(--green); color:#fff; border:none; border-radius:10px; padding:10px 12px;
  cursor:pointer; font-weight:600; transition: filter .15s ease, transform .12s ease;
}
.confirm-btn:hover{ filter:brightness(.96); transform:translateY(-1px); }
.confirm-btn:disabled{ opacity:.6; cursor:not-allowed; }

/* input bar */
.chat-inputbar{
  display:flex; gap:10px; align-items:flex-end; padding:10px; border-top:1px solid var(--ring);
  background:#fff; position:sticky; bottom:0; z-index:1; transition:opacity .3s ease, transform .3s ease;
}
.chat-inputbar.hidden{ opacity:0; transform:translateY(20px); pointer-events:none; }
.chat-inputbar textarea{
  flex:1; resize:none; min-height:42px; max-height:140px; border:1px solid var(--ring); border-radius:14px;
  padding:10px 12px; font-size:15px; outline:none; transition: box-shadow .15s ease, border-color .15s ease;
}
.chat-inputbar textarea:focus{ border-color:#94a3b8; box-shadow:0 0 0 3px rgba(14,165,233,.12); }
.chat-inputbar textarea:disabled{ background:#f9fafb; color:#9ca3af; cursor:not-allowed; }

.send-btn{
  background:var(--teal); color:#fff; border:none; border-radius:12px; padding:10px 16px;
  font-weight:700; cursor:pointer; transition: filter .15s ease, transform .12s ease;
}
.send-btn:hover:not(:disabled){ filter:brightness(.95); transform:translateY(-1px); }
.send-btn:disabled{ background:#9ca3af; cursor:not-allowed; }

/* micro animations */
.pop{ animation: pop .18s ease-out; }
@keyframes pop{ from{ transform:scale(.96); } to{ transform:scale(1); } }

/* responsive */
@media (max-width:640px){
  .bubble{ max-width:86%; }
  .recap-grid{ grid-template-columns:100px 1fr; }
  .user-mini{ display:none; }
  .chat-root{ height:calc(100vh - 40px); margin:8px auto; }
  .help-btn{ padding:10px 20px; font-size:14px; }
}

/* entry animations */
.enter-pop{ animation: enterPop .18s ease-out both; }
.slide-up{ animation: slideUp .22s ease-out both; }
@keyframes enterPop{ from{ transform:scale(.98); opacity:0; } to{ transform:scale(1); opacity:1; } }
@keyframes slideUp{ from{ transform:translateY(6px); opacity:0; } to{ transform:translateY(0); opacity:1; } }

/* Help CTA */
.help-cta{ margin-top:12px; text-align:center; padding:4px 0; }
.help-btn{
  appearance:none;
  background: linear-gradient(135deg,#ef4444,#dc2626);
  color:#fff; border:none; border-radius:999px; padding:12px 24px;
  font-size:16px; font-weight:700; cursor:pointer; display:inline-flex; align-items:center; gap:8px;
  box-shadow:0 4px 12px rgba(239,68,68,.3);
  transition: transform .2s ease, box-shadow .2s ease, filter .15s ease;
}
.help-btn:hover{ transform:translateY(-2px); box-shadow:0 6px 16px rgba(239,68,68,.4); }
.help-btn:active{ transform:translateY(0); }
.help-btn:focus-visible{ outline:none; box-shadow:0 0 0 3px rgba(14,165,233,.28), 0 6px 16px rgba(239,68,68,.35); }
.help-hint{ font-size:12px; color:var(--muted); margin-top:8px; text-align:center; }

/* bounce */
.bounce{ animation: bounce 2s infinite; }
@keyframes bounce{
  0%,20%,50%,80%,100%{ transform:translateY(0); }
  40%{ transform:translateY(-6px); }
  60%{ transform:translateY(-3px); }
}

/* success */
.success-card{
  background:#fff; border-radius:16px; padding:20px; text-align:center;
  border:1px solid var(--ring); box-shadow:0 10px 25px rgba(0,0,0,.1);
}
.check-wrap{ margin-bottom:12px; }
.check{ width:52px; height:52px; }
.check__circle{ stroke:#22c55e; stroke-width:2; animation:stroke .6s cubic-bezier(.65,0,.45,1) forwards; }
.check__check{ stroke:#22c55e; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; animation:stroke .3s cubic-bezier(.65,0,.45,1) .6s forwards; }
@keyframes stroke{ to{ stroke-dashoffset:0; } }
.success-title{ font-weight:700; font-size:18px; margin-bottom:6px; color:var(--ink); }
.success-sub{ color:var(--muted); font-size:14px; }

/* Sticky confirm bar */
.confirm-sticky{
  position: sticky; bottom: 70px; padding: 12px; background:#fff;
  border-top:1px solid var(--ring); display:flex; justify-content:center; z-index:10;
}

/* Division picker (optional styles used by your JSX alt) */
.division-picker{ background:#fff; border:1px solid var(--ring); border-radius:12px; padding:16px; margin-top:8px; }
.division-picker-title{ font-weight:700; margin-bottom:12px; font-size:16px; color:var(--ink); }
.division-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:10px; margin-bottom:12px; }
.division-group{ margin-bottom:12px; }
.division-group-title{ font-weight:600; font-size:14px; color:var(--muted); margin-bottom:8px; padding-bottom:4px; border-bottom:1px solid var(--ring); }
.division-options{ display:flex; flex-direction:column; gap:6px; }
.division-option{
  background:#f8fafc; border:1px solid var(--ring); border-radius:8px; padding:10px 12px;
  cursor:pointer; transition: all .2s ease; font-size:14px; text-align:left;
}
.division-option:hover{ background:#eef2ff; border-color:#a5b4fc; transform:translateY(-1px); }
.division-option.active{ background:var(--teal); color:#fff; border-color:var(--teal); font-weight:600; }
.division-note{ font-size:12px; color:var(--muted); margin-top:12px; padding-top:8px; border-top:1px solid var(--ring); }

/* errors */
.error-message{
  color:#dc2626; background:#fef2f2; border:1px solid #fecaca; border-radius:8px;
  padding:12px; margin:8px 0; font-size:14px;
}

/* more responsive */
@media (max-width:768px){
  .division-grid{ grid-template-columns:1fr; }
  .division-group{ margin-bottom:16px; }
  .chat-inputbar{ padding:8px; }
  .chat-inputbar textarea{ font-size:14px; padding:8px 10px; }
  .send-btn{ padding:8px 12px; font-size:14px; }
}
